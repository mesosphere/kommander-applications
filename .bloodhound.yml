# Kubernetes versions
# (e.g. 1.23.0 - has to match versions in https://github.com/yannh/kubernetes-json-schema)
k8s_versions:
  - 1.32.8
  - 1.33.2
  - 1.34.1

# paths to load (in that order)
paths:
  - applications/kommander/0.17.0/dynamic-helmreleases
  - common/kommander-operator

# use strict validation (reject unknown fields in resources)
strict: true

# types to be skipped (e.g. certmanager.k8s.io/v1, or certmanager.k8s.io/v1/Certificate)
skip_types:
  # constraint types are generated by Gatekeeper
  - constraints.gatekeeper.sh/v1beta1
  - nvidia.com/v1/ClusterPolicy
  - postgresql.cnpg.io/v1/Cluster

# load additional CRDs (URLs of CRD yaml files)
additional_crds:
  # because the istio-chart is just referencing the istio-controller, so it doesn't contain the CRDs
  - https://raw.githubusercontent.com/istio/istio/1.9.1/manifests/charts/base/crds/crd-all.gen.yaml
  # TODO: verify this is not masking real problem in https://d2iq.atlassian.net/browse/D2IQ-99126
  - https://raw.githubusercontent.com/kubernetes-retired/kubefed/master/charts/kubefed/crds/crds.yaml
  - https://raw.githubusercontent.com/cert-manager/cert-manager/master/deploy/crds/cert-manager.io_certificates.yaml
  - https://raw.githubusercontent.com/cert-manager/cert-manager/master/deploy/crds/cert-manager.io_issuers.yaml
#  - https://raw.githubusercontent.com/rook/rook/master/deploy/olm/assemble/objectbucket.io_objectbucketclaims.yaml
  - https://raw.githubusercontent.com/rook/rook/refs/heads/master/deploy/examples/crds.yaml # for rook-ceph-cluster
  - https://raw.githubusercontent.com/mesosphere/charts/refs/heads/master/stable/cosi/crds/apiextensions.k8s.io_v1_customresourcedefinition_bucketaccessclasses.objectstorage.k8s.io.yaml
  - https://raw.githubusercontent.com/mesosphere/charts/refs/heads/master/stable/cosi/crds/apiextensions.k8s.io_v1_customresourcedefinition_bucketaccesses.objectstorage.k8s.io.yaml
  - https://raw.githubusercontent.com/mesosphere/charts/refs/heads/master/stable/cosi/crds/apiextensions.k8s.io_v1_customresourcedefinition_bucketclaims.objectstorage.k8s.io.yaml
  - https://raw.githubusercontent.com/mesosphere/charts/refs/heads/master/stable/cosi/crds/apiextensions.k8s.io_v1_customresourcedefinition_bucketclasses.objectstorage.k8s.io.yaml
  - https://raw.githubusercontent.com/mesosphere/charts/refs/heads/master/stable/cosi/crds/apiextensions.k8s.io_v1_customresourcedefinition_buckets.objectstorage.k8s.io.yaml
  - https://raw.githubusercontent.com/traefik/traefik-helm-chart/refs/heads/master/traefik-crds/crds-files/traefik/traefik.io_ingressroutes.yaml # for nkp-pulse-management
  - https://raw.githubusercontent.com/traefik/traefik-helm-chart/refs/heads/master/traefik-crds/crds-files/traefik/traefik.io_ingressroutetcps.yaml # for cilium-hubble-relay-traefik
  - https://raw.githubusercontent.com/traefik/traefik-helm-chart/refs/heads/master/traefik-crds/crds-files/traefik/traefik.io_middlewares.yaml # for harbor
  - https://raw.githubusercontent.com/prometheus-community/helm-charts/refs/heads/main/charts/kube-prometheus-stack/charts/crds/crds/crd-prometheusrules.yaml # for harbor
  - https://raw.githubusercontent.com/prometheus-community/helm-charts/refs/heads/main/charts/kube-prometheus-stack/charts/crds/crds/crd-servicemonitors.yaml # for ESO and many others
  - https://raw.githubusercontent.com/traefik/traefik-helm-chart/refs/heads/master/traefik-crds/crds-files/traefik/traefik.io_tlsoptions.yaml # for karma
  - https://raw.githubusercontent.com/kube-logging/logging-operator/refs/heads/master/charts/logging-operator/crds/logging.banzaicloud.io_flows.yaml # for project logging
  - https://raw.githubusercontent.com/kube-logging/logging-operator/refs/heads/master/charts/logging-operator/crds/logging.banzaicloud.io_outputs.yaml # for project logging
  - https://raw.githubusercontent.com/kubernetes-sigs/node-feature-discovery/refs/heads/master/deployment/helm/node-feature-discovery/crds/nfd-api-crds.yaml

# set values for substitution variables (e.g. ${releaseNamespace}) in the resources
substitution_vars:
  releaseName: foobar
  releaseNamespace: kommander
  workspaceNamespace: workspace
  certificateIssuerName: issuer
  certificatesIssuerName: issuer
  certificateIssuerKind: ClusterIssuer
  name: this-hack-is-for-kommander-dynamic-helmreleases
  clusterID: this-hack-is-for-kommander-dynamic-helmreleases
  caIssuerName: this-hack-is-only-for-istio-ca-issuer # This might be a bug in istio application definition. TODO.
