---
apiVersion: v1
kind: ConfigMap
metadata:
  name: harbor-valkey-3.0.1-config-defaults
  namespace: ${releaseNamespace}
data:
  values.yaml: |
    ---
    global:
      security:
        allowInsecureImages: true
    image:
      registry: docker.io
      repository: bitnamilegacy/valkey
      tag: 8.1.3-debian-12-r2
    sentinel:
      enabled: true
      image:
        registry: docker.io
        repository: bitnamilegacy/valkey-sentinel
        tag: 8.1.3-debian-12-r2
      primarySet: harbor
    auth:
      enabled: true
      sentinel: false
      existingSecret: harbor-valkey-password
      # This key is required by Harbor helm chart
      existingSecretPasswordKey: REDIS_PASSWORD

    networkPolicy:
      enabled: true
      metrics:
        allowExternal: true
      allowExternal: false
      ingressNSMatchLabels:
        "kubernetes.io/metadata.name": ncr-system

    primary:
      priorityClassName: dkp-critical-priority
    replica:
      priorityClassName: dkp-high-priority

    metrics:
      enabled: true
      image:
        registry: docker.io
        repository: bitnamilegacy/redis-exporter
        tag: 1.74.0-debian-12-r3
      service:
        enabled: true
        extraPorts:
        - name: metrics
          port: 9122
          protocol: TCP
          targetPort: metrics
