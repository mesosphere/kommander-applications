apiVersion: v1
kind: ConfigMap
metadata:
  name: kube-prometheus-stack-mgmt-overrides
  namespace: ${namespace}
data:
  values.yaml: |
    ---
    prometheusSpec:
      # Ensure Thanos sidecar is enabled
      thanos:
        objectStorageConfig: {}
      # Override storage to use smaller PVC (1Gi) for Kind cluster testing
      storageSpec:
        volumeClaimTemplate:
          metadata:
            name: db
          spec:
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 1Gi
    # Grafana: disable persistence (uses emptyDir by default when disabled)
    grafana:
      persistence:
        enabled: false
