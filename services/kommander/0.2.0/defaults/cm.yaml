---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kommander-0.2.0-d2iq-defaults
  namespace: ${releaseNamespace}
data:
  values.yaml: |
    airgapped:
      enabled: ${airgappedEnabled}
    authorizedlister:
      image:
        tag: ${authorizedlisterImageTag}
        repository: ${authorizedlisterImageRepository}
    certificates:
      ca:
        issuer:
          name: ${certificatesCAIssuerName}
      issuer:
        name: ${certificatesIssuerName}
        kind: ${certificateIssuerKind:-Issuer}
      selfSigned: false
    controller:
      containers:
        manager:
          rootCertSecretName: ${caSecretName}
          rootCertSecretNamespace: ${caSecretNamespace}
          image:
            tag: ${controllerManagerImageTag}
            repository: ${controllerManagerImageRepository}
    webhook:
      image:
        tag: ${controllerWebhookImageTag}
        repository: ${controllerWebhookImageRepository}
    fluxOperator:
      containers:
        manager:
          image:
            tag: ${fluxOperatorManagerImageTag}
            repository: ${fluxOperatorManagerImageRepository}
      gitRepo:
        gitCredentialsSecret:
          namespace: kommander-flux
          name: kommander-git-credentials
        ingressCertificateSecret:
          namespace: kommander
          name: kommander-traefik-certificate
        branch: main
    kommander-licensing:
      certificates:
        issuer:
          name: ${certificatesIssuerName}
          kind: ${certificateIssuerKind:-Issuer}
      controller:
        containers:
          manager:
            rootCertSecretName: ${caSecretName}
            image:
              tag: ${licensingControllerManagerImageTag}
              repository: ${licensingControllerManagerImageRepository}
      webhook:
        image:
          tag: ${licensingControllerWebhookImageTag}
          repository: ${licensingControllerWebhookImageRepository}
    kubetools:
      image:
        repository: ${kubetoolsImageRepository}
        tag: ${kubetoolsImageTag}
    kommander-ui:
      ingress:
        enabled: true
        extraAnnotations:
          kubernetes.io/ingress.class: kommander-traefik
          traefik.ingress.kubernetes.io/router.tls: "true"
          traefik.ingress.kubernetes.io/router.middlewares: "${workspaceNamespace}-stripprefixes@kubernetescrd,${workspaceNamespace}-forwardauth@kubernetescrd"
        path: /dkp/kommander/dashboard
        graphqlPath: /dkp/kommander/dashboard/graphql
    attached:
      prerequisites:
        defaultApps:
          reloader: "0.0.104"
          traefik: "10.9.1"
          kubernetes-dashboard: "5.1.1"
          kubecost: "0.22.1"
          kube-prometheus-stack: "32.0.2"
          prometheus-adapter: "2.17.1"
          prometheus-thanos-traefik: "0.0.1"
          kubecost-thanos-traefik: "0.0.1"
          cert-manager: "1.7.1"
          karma-traefik: "0.0.1"
          gatekeeper: "3.7.0"
