apiVersion: v1
kind: ConfigMap
metadata:
  name: velero-7.1.5-d2iq-defaults
  namespace: ${releaseNamespace}
data:
  values.yaml: |
    ---
    priorityClassName: "dkp-critical-priority"
    resources:
      requests:
        cpu: 500m
        memory: 128Mi
      limits:
        cpu: 1000m
        memory: 2Gi
    configuration:
      backupStorageLocation:
        - bucket: dkp-velero
          provider: "aws"
          config:
            region: dkp-object-store
            s3Url: http://rook-ceph-rgw-dkp-object-store.${releaseNamespace}.svc:80/
            s3ForcePathStyle: true
            insecureSkipTLSVerify: "true"
      volumeSnapshotLocation:
        - config:
            region: "fallback"
          provider: "aws"
    credentials:
      extraSecretRef: dkp-velero
    annotations:
      secret.reloader.stakater.com/reload: dkp-velero
    schedules:
      default:
        schedule: "0 0 * * *"
        template:
          ttl: 720h
    metrics:
      enabled: true
      service:
        labels:
          servicemonitor.kommander.mesosphere.io/path: "metrics"
    initContainers:
      - name: velero-plugin-for-aws
        image: velero/velero-plugin-for-aws:v1.10.1
        imagePullPolicy: IfNotPresent
        volumeMounts:
          - mountPath: /target
            name: plugins 
    kubectl:
      image:
        tag: "${kubetoolsImageTag:=1.30.5}"
